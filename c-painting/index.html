<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-6QWVZPE3EJ"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-6QWVZPE3EJ');
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painting in C</title>
    <script src="./main.js" defer></script>
        <style type="text/css">
        body{margin:40px
            auto;max-width:900px;line-height:1.6;font-size:18px;color:#444;padding:0
            10px}h1,h2,h3{line-height:1.2}        .image-container {
            display: flex;
            flex-direction: row;
            height: 30vh;
            gap: 4vh;
            justify-content: center;
        }
        code {
        font-size:12px;
        background-color: #333; /* Dark grey background */
        color: #fff; /* White text */
        padding: 10px;
        display: block;
        overflow-x: auto; /* Adds horizontal scrolling if necessary */
        }
            </style>
        
</head>
<body>
    <h1>Painting in C</h1>
    <aside>Color quantization</aside>
    <div class="image-container">
        <img src="stone.jpg" alt="Image 1">
    </div>
    <h2>Loading the jpg image using stb</h2>
    <pre>
    <code>
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#define STB_IMAGE_IMPLEMENTATION
#include "stb_image.h"
#define STB_IMAGE_WRITE_IMPLEMENTATION
#include "stb_image_write.h"

int main(int argc, char **argv) {
    if (argc < 3) {
        printf("Usage: %s &lt;inputfile&gt; &lt;outputfile&gt;\n", argv[0]);
        return 0;
    }

    int width, height, channels;
    unsigned char *img = stbi_load(argv[1], &width, &height, &channels, 0);
    if (img == NULL) {
        printf("Error in loading the image\n");
        exit(1);
    }

    do_some_conversion(img, width, height, channels);

    stbi_write_jpg(argv[2], width, height, channels, img, 100);
    stbi_image_free(img);

    return 0;
}
    </code>
    </pre>


    <h2>Converting the image to grayscale</h2>
    <pre><code>
void rgb_to_grayscale(unsigned char *data, int width, int height, int channels) {
    for (int i = 0; i < width * height; i++) {
        int index = i * channels;
        unsigned char r = data[index];
        unsigned char g = data[index + 1];
        unsigned char b = data[index + 2];
        // Standard formula for luminance
        unsigned char gray = (unsigned char)(0.299 * r + 0.587 * g + 0.114 * b);
        data[index] = data[index + 1] = data[index + 2] = gray;
    }
}
    </code></pre>
    <div class="image-container">
        <img src="grayscale_output.jpg" alt="Image 2">
    </div>

    <h2>Quantization of the image</h2>
    <pre><code>
void color_quantize(unsigned char *data, int width, int height, int channels, int levels) {
    int color_div = 256 / levels;
    for (int i = 0; i < width * height * channels; i += channels) {
        for (int c = 0; c < channels; c++) {  // Apply to RGB, not A if present
            int quantized = (data[i + c] / color_div) * color_div + color_div / 2;
            data[i + c] = (unsigned char)quantized;
        }
    }
}
    </code></pre>
    <div class="image-container">
        <img src="quantize_output.jpg" alt="Image 3">
    </div>

    <p>https://www.ctralie.com/PrincetonUGRAD/Projects/JPEG/jpeg.pdf</p>
    <p>https://koushtav.me/jpeg/tutorial/c++/decoder/2019/03/02/lets-write-a-simple-jpeg-library-part-2/</p>
    <p>https://github.com/nothings/stb</p>
    <script src="main.js"></script>
</body>
</html>
